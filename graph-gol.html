<!DOCTYPE html>
<html>
<head>

<link rel="stylesheet" type="text/css" href="graph.css">
<link href='https://fonts.googleapis.com/css?family=Roboto:300' rel='stylesheet' type='text/css'>

</head>
<body>

<div id = "canvasbox">
<canvas id = "graph">Your browser does not support the HTML5 canvas tag.</canvas>
</div>

<div id = "menu">
<p style = "text-align: center;">info</p>
<p id = "fps">info</p>
<h1>Game of Life</h1>
<p>Draw alive cells and press the q,w,e,r,t,y keys to choose the play speed and p to pause. </p>
<p>Grid size:</p>
<div style="width:300px;height:100px;">
<p class = "hoverbutton" id = "reset" >reset</p>
<p class = "hoverbutton" id = "bb" >2</p>
<p class = "hoverbutton" id = "cc" >5</p>
<p class = "hoverbutton" id = "dd" >10</p>
<p class = "hoverbutton" id = "ee" >20</p>
<p class = "hoverbutton" id = "ff">50</p>
</div>
<p>Depending on the number of neighbours, a cell will die, survive, or be born.</p>
<p>Choose which cells survive and are born:</p>
<!--<p class = "radiobutton"> 0: <input type="radio" name="0" value="dead" checked="checked" onclick="does[0] = 0;"> death <input type="radio" name="0" value="alive" onclick="does[0] = 1;"> survival <input type="radio" name="0" value="born" onclick="does[0] = 2;"> birth</p>
<p class = "radiobutton"> 1: <input type="radio" name="1" value="dead" checked="checked" onclick="does[1] = 0;"> death <input type="radio" name="1" value="alive" onclick="does[1] = 1;"> survival <input type="radio" name="1" value="born" onclick="does[1] = 2;"> birth</p>
<p class = "radiobutton"> 2: <input type="radio" name="2" value="dead" onclick="does[2] = 0;"> death <input type="radio" name="2" value="alive" checked="checked" onclick="does[2] = 1;"> survival <input type="radio" name="2" value="born" onclick="does[2] = 2;"> birth</p>
<p class = "radiobutton"> 3: <input type="radio" name="3" value="dead" onclick="does[3] = 0;"> death <input type="radio" name="3" value="alive" onclick="does[3] = 1;"> survival <input type="radio" name="3" value="born" checked="checked" onclick="does[3] = 2;"> birth</p>
<p class = "radiobutton"> 4: <input type="radio" name="4" value="dead" checked="checked" onclick="does[4] = 0;"> death <input type="radio" name="4" value="alive" onclick="does[4] = 1;"> survival <input type="radio" name="4" value="born" onclick="does[4] = 2;"> birth</p>
<p class = "radiobutton"> 5: <input type="radio" name="5" value="dead" checked="checked" onclick="does[5] = 0;"> death <input type="radio" name="5" value="alive" onclick="does[5] = 1;"> survival <input type="radio" name="5" value="born" onclick="does[5] = 2;"> birth</p>
<p class = "radiobutton"> 6: <input type="radio" name="6" value="dead" checked="checked" onclick="does[6] = 0;"> death <input type="radio" name="6" value="alive" onclick="does[6] = 1;"> survival <input type="radio" name="6" value="born" onclick="does[6] = 2;"> birth</p>
<p class = "radiobutton"> 7: <input type="radio" name="7" value="dead" checked="checked" onclick="does[7] = 0;"> death <input type="radio" name="7" value="alive" onclick="does[7] = 1;"> survival <input type="radio" name="7" value="born" onclick="does[7] = 2;"> birth</p>
<p class = "radiobutton"> 8: <input type="radio" name="8" value="dead" checked="checked" onclick="does[8] = 0;"> death <input type="radio" name="8" value="alive" onclick="does[8] = 1;"> survival <input type="radio" name="8" value="born" onclick="does[8] = 2;"> birth</p>-->
<p style="width:100px;float:left;">survival: </p>
<div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">0</p>
	<input type="checkbox" value="None" id="survival0" name="check0" onclick="survival[0]=document.getElementById('survival0').checked"/>
	<label for="survival0"></label>
</div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">1</p>
	<input type="checkbox" value="None" id="survival1" name="check1" onclick="survival[1]=document.getElementById('survival1').checked" />
	<label for="survival1"></label>
</div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">2</p>
	<input type="checkbox" value="None" id="survival2" name="check2" onclick="survival[2]=document.getElementById('survival2').checked" />
	<label for="survival2"></label>
</div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">3</p>
	<input type="checkbox" value="None" id="survival3" name="check3" onclick="survival[3]=document.getElementById('survival3').checked" />
	<label for="survival3"></label>
</div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">4</p>
	<input type="checkbox" value="None" id="survival4" name="check4" onclick="survival[4]=document.getElementById('survival4').checked" />
	<label for="survival4"></label>
</div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">5</p>
	<input type="checkbox" value="None" id="survival5" name="check5" onclick="survival[5]=document.getElementById('survival5').checked" />
	<label for="survival5"></label>
</div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">6</p>
	<input type="checkbox" value="None" id="survival6" name="check6" onclick="survival[6]=document.getElementById('survival6').checked" />
	<label for="survival6"></label>
</div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">7</p>
	<input type="checkbox" value="None" id="survival7" name="check7" onclick="survival[7]=document.getElementById('survival7').checked" />
	<label for="survival7"></label>
</div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">8</p>
	<input type="checkbox" value="None" id="survival8" name="check8" onclick="survival[8]=document.getElementById('survival8').checked" />
	<label for="survival8"></label>
</div></div>

<p style="width:100px;float:left;">birth: </p>
<div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">0</p>
	<input type="checkbox" value="None" id="birth0" name="check0" onclick="birth[0]=document.getElementById('birth0').checked" />
	<label for="birth0"></label>
</div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">1</p>
	<input type="checkbox" value="None" id="birth1" name="check1" onclick="birth[1]=document.getElementById('birth1').checked" />
	<label for="birth1"></label>
</div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">2</p>
	<input type="checkbox" value="None" id="birth2" name="check2" onclick="birth[2]=document.getElementById('birth2').checked" />
	<label for="birth2"></label>
</div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">3</p>
	<input type="checkbox" value="None" id="birth3" name="check3" onclick="birth[3]=document.getElementById('birth3').checked" />
	<label for="birth3"></label>
</div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">4</p>
	<input type="checkbox" value="None" id="birth4" name="check4" onclick="birth[4]=document.getElementById('birth4').checked" />
	<label for="birth4"></label>
</div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">5</p>
	<input type="checkbox" value="None" id="birth5" name="check5" onclick="birth[5]=document.getElementById('birth5').checked" />
	<label for="birth5"></label>
</div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">6</p>
	<input type="checkbox" value="None" id="birth6" name="check6" onclick="birth[6]=document.getElementById('birth6').checked" />
	<label for="birth6"></label>
</div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">7</p>
	<input type="checkbox" value="None" id="birth7" name="check7" onclick="birth[7]=document.getElementById('birth7').checked" />
	<label for="birth7"></label>
</div>
<div class="squaredFour">
	<p style="margin-left:5px;height: 5px;">8</p>
	<input type="checkbox" value="None" id="birth8" name="check8" onclick="birth[8]=document.getElementById('birth8').checked" />
	<label for="birth8"></label>
</div>
</div>
</div>

<div id="winner">
	<h1>you win!</h1>
	<p><a href="graph-maze.html">next</a></p>
</div>

<div id = "footer">
<p style = "text-align:center;"><a href="graph-fluid.html">previous</a> | <a href="graph-maze.html">next</a> </p>
</div>

<script>
var c = document.getElementById("graph");
var paper = c.getContext("2d");
W=window.innerWidth;
H=window.innerHeight;
dx = 20;
c.width = W;
c.height = H;
var t = 0;
var dt = .001;
paper.fillStyle = 'rgba(255,255,255,1)';
paper.fillRect(0,0,W,H);

document.getElementById("survival2").checked = true;
document.getElementById("survival3").checked = true;
document.getElementById("birth3").checked = true;
var survival = [0,0,1,1,0,0,0,0,0];
var birth = [0,0,0,1,0,0,0,0,0];
xs = [];
ys = [];
life = [];
pastlife = [];
for (var i = 0; i < W/dx+1; i++){
	xs[i]=[];
	ys[i]=[];
	life[i] = [];
	pastlife[i] = [];
	for (var j = 0; j < H/dx+1; j++){
		xs[i][j] = (i-1)*dx+dx/2+.5;
		ys[i][j] = (j-1)*dx+dx/2+.5;
		life[i][j] =0;
		pastlife[i][j] =0;
	}
}

paper.fillStyle="#679";
paper.strokeStyle="#bce";
//drawpoints(xs,ys,W,H,dx)
//drawlines(xs,ys,W,H,dx)

var upkey = 0;
var downkey = 0;
var leftkey = 0;
var rightkey = 0;
var xold = -1;
var yold = -1;
var xpos = -1;
var ypos = -1;
var clicked = 0;
var qwerty = 10000000;
var setint = setInterval(runlife, qwerty);

draw(dt);
animate(draw);
runlife();

function init(){
	xs = [];
	ys = [];
	life = [];
	pastlife = [];
	for (var i = 0; i < W/dx+1; i++){
		xs[i]=[];
		ys[i]=[];
		life[i] = [];
		pastlife[i] = [];
		for (var j = 0; j < H/dx+1; j++){
			xs[i][j] = (i-1)*dx+dx/2+.5;
			ys[i][j] = (j-1)*dx+dx/2+.5;
			life[i][j] =0;
			pastlife[i][j] =0;
		}
	}

	paper.fillStyle="#679";
	paper.strokeStyle="#bce";
	//drawpoints(xs,ys,W,H,dx)
	//drawlines(xs,ys,W,H,dx)

	var upkey = 0;
	var downkey = 0;
	var leftkey = 0;
	var rightkey = 0;
	var xold = -1;
	var yold = -1;
	var xpos = -1;
	var ypos = -1;
	var clicked = 0;

	draw(dt);
	animate(draw);
}

function addhole(x,y){
paper.fillStyle="#679";
paper.beginPath();
paper.arc(x, y, dx/1.5, 0, 2 * Math.PI);
paper.stroke();
paper.fill();
paper.beginPath();
paper.arc(x+1, y+1, dx/1.5, 0, 2 * Math.PI);
paper.stroke();
paper.fillStyle="white";
paper.fill();
}

function drawpoints(xs,ys,W,H,dx){
	for (var i = 0; i < W/dx+1; i++){
		for (var j = 0; j < H/dx+1; j++){
			paper.beginPath();
			paper.arc(xs[i][j], ys[i][j], 1, 0, 2 * Math.PI);
			paper.stroke();
			paper.fill();
		}
	}
}

function drawlines(xs,ys,W,H,dx){
	paper.strokeStyle="#bce";
	for (var i = 0; i < W/dx; i++){
		for (var j = 0; j < H/dx; j++){	
			paper.beginPath();
			paper.moveTo(xs[i][j],ys[i][j]);
			paper.lineTo(xs[i+1][j], ys[i+1][j]);
			paper.lineTo(xs[i+1][j+1],ys[i+1][j+1]);
			paper.stroke();
		}
	}
}

function drawlife(xs,ys,W,H,dx){
	paper.fillStyle="#bce";
	for (var i = 0; i < W/dx; i++){
		for (var j = 0; j < H/dx; j++){
			if(life[i][j]){
				paper.beginPath();
				paper.moveTo(xs[i][j],ys[i][j]);
				paper.lineTo(xs[i+1][j], ys[i+1][j]);
				paper.lineTo(xs[i+1][j+1], ys[i+1][j+1]);
				paper.lineTo(xs[i][j+1],ys[i][j+1]);
				paper.moveTo(xs[i][j],ys[i][j]);
				paper.fill();
			}
		}
	}
}

function draw(dt){
	paper.fillStyle = 'rgba(255,255,255,1)';
	paper.fillRect(0,0,W,H);
	paper.fillStyle="#679";
	paper.strokeStyle="#bce";
	if(clicked){
		gridi = parseInt((xpos-(dx/2+.5))/dx+1);
		gridj = parseInt((ypos-(dx/2+.5))/dx+1);
		life[gridi][gridj] = 1;
	}
	xold = xpos
	yold = ypos
	copy(life,pastlife);
	/*if(rightkey){
		for (var i = 1; i < W/dx-1; i++){
			for (var j = 1; j < H/dx-1; j++){
				evolve(i,j);
			}
		}
	}*/
	drawlife(xs,ys,W,H,dx);
	if(dx>=10){
		drawlines(xs,ys,W,H,dx);
	}
}

function runlife(){
	//if(qwerty){
		copy(life,pastlife);
		for (var i = 1; i < W/dx-1; i++){
			for (var j = 1; j < H/dx-1; j++){
				evolve(i,j);
			}
		}
	//}
}

function copy(from,to){
	for (var i = 1; i < W/dx-1; i++){
		for (var j = 1; j < H/dx-1; j++){
			to[i][j] = from[i][j];
		}
	}
}

function evolve(i,j){
	var count = 0;
	for (var k = i-1;k<=i+1;k++){
		for (var l = j-1; l<=j+1; l++){
			if (pastlife[k][l]){
				count ++;
			}
		}
	}
	count-=pastlife[i][j];
	life[i][j]=0;
	if(survival[count]&&pastlife[i][j]){
		life[i][j]=1;
	} else if (birth[count]&&!pastlife[i][j]) {
		life[i][j]=1;
	}
}

document.onmousemove = coords;
document.onmousedown = click;
document.onmouseup = declick;

function coords(e){
	xpos = e.clientX;
	ypos = e.clientY;
}

function click (){
	clicked = 1;
}
function declick (){
	clicked = 0;
}

document.onkeydown = keypressed;
//document.onkeyup = keydepressed;

function keypressed(e) {

    e = e || window.event;

    if (e.keyCode == '81') {
        // q
		//if(qwerty==0){
			//qwerty = 1000000000000000;
			//clearInterval(setint);
			//var setint = setInterval(runlife, qwerty);
		//}
		clearInterval(setint);
		setTimeout(runlife(),qwerty);
		qwerty=0;
    }
    else if (e.keyCode == '87') {
        // w
		//if(qwerty==0){
			qwerty = 1000;
			clearInterval(setint);
			setint = setInterval(runlife, qwerty);
		//}
    }
    else if (e.keyCode == '69') {
       // e
		//if(qwerty==0){
			qwerty = 500;
			clearInterval(setint);
			setint = setInterval(runlife, qwerty);
		//}
    }
    else if (e.keyCode == '82') {
       // r
		//if(qwerty==0){
			qwerty = 100;
			clearInterval(setint);
			setint = setInterval(runlife, qwerty);
		//}
    }
    else if (e.keyCode == '84') {
       // t
		//if(qwerty==0){
			qwerty = 50;
			clearInterval(setint);
			setint = setInterval(runlife, qwerty);
		//}
    }
    else if (e.keyCode == '89') {
       // y
		//if(qwerty==0){
			qwerty = 1;
			clearInterval(setint);
			setint = setInterval(runlife, qwerty);
		//}
    }
    else if (e.keyCode == '80') {
       // y
		//if(qwerty==0){
			qwerty = 0;
			clearInterval(setint);
		//}
    }
}
function keydepressed(e) {

    e = e || window.event;

    if (e.keyCode == '81') {
        // q
		qwerty = 0;
		clearInterval(setint);
    }
    else if (e.keyCode == '87') {
        // w
		qwerty = 0;
		clearInterval(setint);
    }
    else if (e.keyCode == '69') {
		// e
		qwerty = 0;
		clearInterval(setint);
    }
    else if (e.keyCode == '82') {
		// r
		qwerty = 0;
		clearInterval(setint);
    }
    else if (e.keyCode == '84') {
		// t
		qwerty = 0;
		clearInterval(setint);
    }
    else if (e.keyCode == '89') {
		// y
		qwerty = 0;
		clearInterval(setint);
    }
}

function animate( render ) {
    var running, lastFrame = +new Date;
    function loop( now ) {
        // stop the loop if render returned false
        if ( running !== false ) {
            requestAnimationFrame( loop );
            var deltaT = now - lastFrame;
			document.getElementById("fps").innerHTML = "fps: " + deltaT;

            // do not render frame when deltaT is too high
            if ( deltaT < 160) {
                running = render( deltaT );
            }
            lastFrame = now;
        } else {			
			var el = document.getElementById("winner");
			el.style.display = 'block';
			won =1;
		}
    }
    loop( lastFrame );
	
window.onload = function() {
	reset.onmousedown = function() {
		paper.fillStyle = 'rgba(255,255,255,1)';
		paper.fillRect(0,0,W,H);
		setTimeout(init, 500);
		return false;
	}
	bb.onmousedown = function() {
		dx = 2;
		paper.fillStyle = 'rgba(255,255,255,1)';
		paper.fillRect(0,0,W,H);
		setTimeout(init, 500);
		return false;
	}
	cc.onmousedown = function() {
		dx = 5;
		paper.fillStyle = 'rgba(255,255,255,1)';
		paper.fillRect(0,0,W,H);
		setTimeout(init, 500);
		return false;
	}
	dd.onmousedown = function() {
		dx = 10;
		paper.fillStyle = 'rgba(255,255,255,1)';
		paper.fillRect(0,0,W,H);
		setTimeout(init, 500);
		return false;
	}
	ee.onmousedown = function() {
		dx = 20;
		paper.fillStyle = 'rgba(255,255,255,1)';
		paper.fillRect(0,0,W,H);
		setTimeout(init, 500);
		return false;
	}
	ff.onmousedown = function() {
		dx = 50;
		paper.fillStyle = 'rgba(255,255,255,1)';
		paper.fillRect(0,0,W,H);
		setTimeout(init, 500);
		return false;
	}
}
}
</script>

</body>
</html>


